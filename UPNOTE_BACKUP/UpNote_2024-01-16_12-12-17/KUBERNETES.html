<head><title></title><meta charset="utf-8"><link rel="stylesheet" href="./styles.css"></head><body class="light-theme blue_sky" style="padding: 20px;"><div class="shine-editor">KUBERNETES:<br><br><ol><li>Cluster Architecture:</li><ul><li><img width="100%" src="Files/image.png"><br></li></ul></ol><div><b><br></b></div><ol><ul><li><b><i>MASTER NODE</i></b> - Manage, plan, schedule, monitor</li><li><b><i>WORKER NODES</i> </b>- Host application as containers</li><li><b><i>ETCD</i> </b>- Database which stores time and event in key:value format</li><li><b><i>kube-scheduler</i> </b>- Identifies the right node size, capacity, destination, type of containers, etc.</li><li><b><i>controller manager</i> </b>- Job is to make sure that the container is available all the time, when there’s failure, it makes it avail.</li><ul><ul><li>controller manager</li><li>node controller</li><li>replication controller</li></ul></ul><li><b><i>kube-api server </i></b>- Orchestrates all operations within a cluster (kube-scheduler + ETCD + Controller-Manager)</li><li><i><b>Container Runtime Engines</b> </i>- runs the containers</li><ul><ul><li>Docker</li><li>rkt</li></ul></ul><li><b><i>kubelet </i></b>- Engine that runs on each node in a cluster, listens for instructions from kube-api server and deploys containers on the nodes, fetches info of nodes periodically to monitor status of node.</li><li><b><i>kube-proxy server</i></b></li></ul></ol><div><br></div><div><br></div><div><br></div><ol><ul><li><b><u>SUMMARY:</u></b></li></ul></ol><div><b><u><br></u></b></div><ol><ul><ul><li><b><i>MASTER NODE:</i></b></li></ul></ul></ol><ol><ul><ul><ul><li><b>ETCD</b> - Stores information about the cluster</li><li><b>kube-scheduler</b> - Schedules applications or containers on the nodes</li><li><b>Controllers</b> - Takes care of different fucntions</li><ul><li>Node controller</li><li>Replication controller</li></ul><li><b>kube-api Server </b>- Orchestrates all operations within a cluster</li></ul></ul></ul></ol><div><br></div><ol><ul><ul><li><b><i>WORKER NODE:</i></b></li><ul><li><b>kubelet</b> - Listens for instructions from the kube-apiserver and manages containers</li><li><b>kube-proxy </b>- Helps in enabling communication between services within the cluster</li><li><b>Container Runtime Engine</b> - Docker, rkt</li></ul></ul></ul></ol><div><br></div><div><ol start="2"><li><b><u>DOCKER vs. CONTAINER:</u></b><img width="100%" src="Files/image%202.png"></li></ol></div><div><br></div><div><ol start="3"><li>ETCD:</li><ul><li>key-value store - each individual gets a document</li><li>change of one document doesn’t affect others</li><li>Listens on port 2379</li><li>Control Client - etcdctl</li><ul><li>to store a key-value pair:</li><ul><li>./etcdctl set key1 value1&nbsp; &nbsp;#creates an entry in the database</li></ul></ul><li>It stores the following info regarding cluster:</li><ul><ul><li>Nodes</li><li>Pods</li><li>Roles</li><li>Secrets</li><li>Bindings</li><li>Others</li></ul></ul><li>2 Ways of Setting up ETCD:</li><ul><ul><li>From <b><i>scratch</i></b> - by downloading binaries</li><ul><li>--advertise-client-urls https://${INTERNAL_IP}:2379</li></ul><li>From <b><i>kubeadm</i></b></li><ul><li>deploys ETCD as a POD</li></ul></ul></ul></ul></ol><div><br></div><div><ol start="4"><li>Kube-API Server:</li></ol><div><br></div></div></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><b><hr>PODS WITH YAML:</b></div><div><img width="50%" src="Files/image%203.png"><br></div><div><img width="50%" src="Files/image%204.png"><br></div><div><br></div><div><b>NOTE: </b>Indentation with 2 spaces instead of TAB Space!</div><div>   Under <span class="shine-text-red">metadata</span>, we can only add name or label</div><div>   Under <span class="shine-text-red">spec</span>, it is different for different kubernetes object</div><div>     Under spec, we have list of containers</div><div>       Under containers, we have a dictionary</div><div><br></div><div><b>POD:</b></div><div><span class="shine-text-yellow"><span data-formula-width-em="12.5" data-upnote-formula="pod-definition.yml - file" data-non-editable="true">pod-definition.yml - file</span></span></div><div><span class="shine-text-yellow">api-version: v1</span></div><div><span class="shine-text-yellow">kind: pod</span></div><div><span class="shine-text-yellow">metadata:</span></div><div><span class="shine-text-yellow"> </span><span class="shine-text-yellow">name: myapp-pod     STRING</span></div><div><span class="shine-text-yellow"> </span><span class="shine-text-yellow">labels:&nbsp;          DICTIONARY</span></div><div><span class="shine-text-yellow"> </span><span class="shine-text-yellow"> </span><span class="shine-text-yellow">app: myapp</span></div><div><span class="shine-text-yellow">  tier: front-end<br></span></div><div><br></div><div><span class="shine-text-yellow">spec:&nbsp;</span></div><div><span class="shine-text-yellow"> containers:        LIST / ARRAY<br></span></div><div><span class="shine-text-yellow"> - name: nginx-container   DICTIONARY<br></span></div><div><span class="shine-text-yellow"> &nbsp; image: nginx<br></span></div><div><span class="shine-text-yellow"> - name: busybox<br></span></div><div><span class="shine-text-yellow"> &nbsp; &nbsp;image: busybox<br></span></div><div><br></div><div><b>To create a pod:</b></div><div> - kubectl create -f pod-definition.yml</div><div>     or</div><div> - kubectl apply -f pod-definition.yml</div><div><br></div><div><b>To view a pod:</b></div><div><b> - </b>kubectl get pods</div><div>     or</div><div><b> </b>- kubectl describe pod myapp-pod&nbsp; &nbsp;or kubectl describe pod nginx</div><div><br></div><div><b>To view help related to pod:</b></div><div><b> - </b>kubectl run --help</div><div><b><br></b></div><div><b><i>TEST:</i></b></div><div><ol><li>⁠How many pods are there in the current namespace(default)?</li></ol><ol start="2"><ul><ul><li>kubectl get pods → Displays the pod details and the number of pods</li></ul></ul></ol><div><br></div><ol start="2"><li>Create a new pod with the&nbsp;<code spellcheck="false">nginx</code>&nbsp;image.</li><ul><ul><ul><ul><li><span data-formula-width-em="6" data-upnote-formula="name: nginx" data-non-editable="true">name: nginx</span></li></ul></ul><li>kubeclt run nginx --image=nginx</li></ul></ul></ol><div><br></div><ol start="3"><li><div>How many pods are created now? <i>(Note: We have created a few more pods. So please check again.)</i></div></li><ul><ul><li>kubectl get pods</li></ul></ul></ol><div><br></div><div><ol start="4"><li>What is the image used to create the new pods? <i>(You must look at one of the new pods in detail to figure this out.)</i></li><ul><ul><li>kubectl get pods</li><li>kubectl describe pod newpod-d5fr6</li><li><img width="50%" src="Files/image%205.png"><br></li></ul></ul></ol></div><div><i><br></i></div><div><ol start="5"><li>Which nodes are these pods placed on? <i>(You must look at all the pods in detail to figure this out.)</i></li><ul><ul><li>kubectl get pods</li><li>kubectl describe pod newpods-qnf22</li><li><img width="50%" src="Files/image%206.png"><br></li><li><i><b>Answer:</b> </i>controlplane</li></ul></ul></ol><div><br></div><ol start="6"><li>How many containers are in pod webapp?</li><ul><ul><li>kubectl get pods</li><li>kubectl describe pod webapp</li><li><img width="50%" src="Files/image%207.png"><br></li><li><i><b>Answer: </b></i>2 (Containers: nginx &amp; agentx)</li></ul></ul></ol><div><br></div></div><div><ol start="7"><li>What images are used in the new&nbsp;<code spellcheck="false">webapp</code>&nbsp;pod? <i>(You must look at all the pods in detail to figure this out.)</i></li><ul><ul><li>kubectl get pods</li><li>kubectl describe pod webapp</li><li><img width="50%" src="Files/image%208.png"><br></li><li><i><b>Answer: </b></i>nginx &amp; agentx</li></ul></ul></ol></div><div><br></div></div><div><ol start="8"><li>What is the state of the container&nbsp;<code spellcheck="false">agentx</code>&nbsp;in the pod&nbsp;<code spellcheck="false">webapp</code>? <i>(Wait for it to finish the&nbsp;<code spellcheck="false">ContainerCreating</code>&nbsp;state)</i></li><ul><ul><li>kubectl get pods</li><li>kubectl describe pod webapp</li><li><img width="50%" src="Files/image%209.png"><br></li></ul></ul></ol><div><br></div></div><div><ol start="9"><li>Why do you think the container&nbsp;<code spellcheck="false">agentx</code>&nbsp;in pod&nbsp;<code spellcheck="false">webapp</code>&nbsp;is in error? <i>(Try to figure it out from the events section of the pod.)</i></li><ul><ul><ul><ul><ul><li><i>NGINX application isn't configured to communicate to this image</i></li><li><i>The application inside this image is faulty</i></li><li><i>A Docker image with this name doesn't exist on Docker Hub</i></li><li><i>Faulty Kubernetes cluster</i></li></ul></ul></ul></ul></ul></ol><ol><ul><ul><li>kubectl get pods</li><li>kubectl describe pod webapp</li><li><img width="50%" src="Files/image%2010.png"><br></li><li><b><i>Answer:&nbsp;</i></b>A Docker image with this name doesn't exist on Docker Hub</li></ul></ul></ol><div><br></div></div><div><ol data-upnote-marker-digit-count="2" start="10"><li>What does the&nbsp;<code spellcheck="false">READY</code>&nbsp;column in the output of the&nbsp;<code spellcheck="false">kubectl get pods</code>&nbsp;command indicate?</li><ul><ul><ul><ul><li><i>Running Pods/Total Pods</i></li><li><i>Total Containers in POD/Running Containers in POD</i></li><li><i>Running Containers in POD/Total Containers in POD</i></li><li><i>Total Pods/Running Pods</i></li></ul></ul><li>kubectl get pods</li><li><img width="50%" src="Files/image%2011.png"><br></li><li><b><i>Answer:&nbsp;</i></b>Running Containers in POD/Total Containers in POD</li></ul></ul></ol><div><br></div></div><div><ol data-upnote-marker-digit-count="2" start="11"><li>Delete the&nbsp;<code spellcheck="false">webapp</code>&nbsp;Pod. <i>(Once deleted, wait for the pod to fully terminate.)</i></li><ul><ul><ul><ul><li><i><span data-formula-width-em="6.8125" data-upnote-formula="Name: webapp" data-non-editable="true">Name: webapp</span></i></li></ul></ul><li>kubectl delete --help</li><li>kubectl delete pod webapp</li><li><img width="50%" src="Files/image%2012.png"><br></li></ul></ul></ol><div><br></div></div><div><ol data-upnote-marker-digit-count="2" start="12"><li>Create a new pod with the name&nbsp;<code spellcheck="false">redis</code>&nbsp;and the image&nbsp;<code spellcheck="false">redis123</code>. <i>(Use a pod-definition YAML file. And yes the image name is wrong!)</i></li><ul><ul><li>kubectl run redis --image=redis123 --dry-run=client -o yaml&nbsp; &nbsp; &nbsp; &nbsp;<i><span class="shine-text-blue">(This will create a code like shown below)</span></i><br></li><ul><ul><li><span class="shine-text-orange">apiVersion: v1</span><br><span class="shine-text-orange">kind: Pod</span><br><span class="shine-text-orange">metadata:</span><br><span class="shine-text-orange">&nbsp; creationTimestamp: null</span><br><span class="shine-text-orange">&nbsp; labels:</span><br><span class="shine-text-orange">&nbsp; &nbsp; run: redis</span><br><span class="shine-text-orange">&nbsp; name: redis</span><br><span class="shine-text-orange">spec:</span><br><span class="shine-text-orange">&nbsp; containers:</span><br><span class="shine-text-orange">&nbsp; - image: redis123</span><br><span class="shine-text-orange">&nbsp; &nbsp; name: redis</span><br><span class="shine-text-orange">&nbsp; &nbsp; resources: {}</span><br><span class="shine-text-orange">&nbsp; dnsPolicy: ClusterFirst</span><br><span class="shine-text-orange">&nbsp; restartPolicy: Always</span><br><span class="shine-text-orange">status: {}</span></li><li>⁠kubectl run redis --image=redis123 --dry-run=client -o yaml &gt; redis-definition.yaml</li><ul><li><i><span class="shine-text-blue">(This creates a yaml file called redis-definition.yaml with above code inside it.)</span></i></li></ul></ul><ul><li>kubectl create -f redis-definition.yaml⁠</li><ul><li><i><span class="shine-text-blue">(This creates a pod with the redis-definition.yaml file.)</span></i></li></ul></ul></ul></ul></ul></ol><div><i><br></i></div></div><div><ol data-upnote-marker-digit-count="2" start="13"><li>Now change the image on this pod to&nbsp;<code spellcheck="false">redis</code>. <i>(Once done, the pod should be in a&nbsp;<code spellcheck="false">running</code>&nbsp;state.)</i></li><ul><ul><ul><ul><ul><li><div><i><span data-formula-width-em="5.9375" data-upnote-formula="Name: redis" data-non-editable="true">Name: redis</span></i></div></li><li><div><i><span data-formula-width-em="8.5" data-upnote-formula="Image name: redis" data-non-editable="true">Image name: redis</span></i></div></li></ul></ul></ul><li>kubectl get pods</li><li>cat redis-definition.yaml&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <i><span class="shine-text-blue">(To check for image, here it would display image: redis123)</span></i></li><li>⁠nano redis-definition.yaml&nbsp;<i><span class="shine-text-blue">&nbsp; &nbsp; &nbsp; &nbsp; (Change image: redis)</span></i></li></ul></ul></ol><ol><ul><ul><li>kubectl apply -f redis-definition.yaml<span class="shine-text-blue"><br></span></li><li><img width="50%" src="Files/image%2013.png"><br></li></ul></ul></ol><div><br></div><div><br></div><div><br></div><div><b>RC: (REPLICATION CONTROLLER)</b></div></div><div><span data-formula-width-em="12.75" data-upnote-formula="rc-definition.yml =>file" data-non-editable="true">rc-definition.yml =&gt;file</span><br></div><div><br></div><div>NOTE: Under spec for rc-definition.yml - file,&nbsp;</div><div>   we have the ‘metadata of pod’...!</div><div><br></div><div><span class="shine-text-yellow">api-version: v1</span></div><div><span class="shine-text-yellow">kind: ReplicationController</span></div><div><span class="shine-text-yellow">metadata:         &nbsp; METADATA OF REPLICATION CONTROLLER</span></div><div><span class="shine-text-yellow"> </span><span class="shine-text-yellow">name: myapp-rc&nbsp; &nbsp;     STRING</span></div><div><span class="shine-text-yellow"> </span><span class="shine-text-yellow">labels:&nbsp;          DICTIONARY</span></div><div><span class="shine-text-yellow"> </span><span class="shine-text-yellow"> </span><span class="shine-text-yellow">app: myapp</span></div><div><span class="shine-text-yellow">  tier: front-end<br></span></div><div><br></div><div><span class="shine-text-yellow">spec:&nbsp;</span></div><div><span class="shine-text-yellow"> template:<hr></span></div><div><span class="shine-text-yellow">  metadata:       METADATA OF THE POD<br></span></div><div><span class="shine-text-yellow">   name: myapp-pod<br></span></div><div><span class="shine-text-yellow">   labels:<br></span></div><div><span class="shine-text-yellow">    app: myapp<br></span></div><div><span class="shine-text-yellow">    type: frontend<br></span></div><div><span class="shine-text-yellow">  spec:<br></span></div><div><span class="shine-text-yellow">   containers:<br></span></div><div><span class="shine-text-yellow">   - name: nginx-container<br></span></div><div><span class="shine-text-yellow">   &nbsp; &nbsp;image: nginx</span></div><div><span class="shine-text-yellow"><hr>replicas: 3</span></div><div><span class="shine-text-yellow"><br></span></div><div>⁠<b>To create a replication controller:</b></div><div>⁠- kubectl create -f rc-definition.yml<span class="shine-text-yellow"><br></span></div><div><br></div><div><b>To view created replication controller:</b></div><div>- kubectl get replicationcontroller</div><div><br></div><div>⁠<b>To view pods created by replication contoller: </b>(All their names would start same)<span class="shine-text-yellow"><br></span></div><div>- kubectl get pods</div><div><br></div><div><br></div><div><br></div><div><br></div><div><b>REPLICASET: (</b>Used for scaling, lil different from Replication Contoller<b>)</b><br></div><div><span data-formula-width-em="16.25" data-upnote-formula="replicaset-definition.yml =>file" data-non-editable="true">replicaset-definition.yml =&gt;file</span><br></div><div><br></div><div>NOTE: api-version is ‘apps/v1’</div><div>   Under replicas label, we have an additional label called ‘matchLabels’.</div><div>   The rest of the contents are same as of the contents on rc-definition.yml.</div><div><br></div><div><span class="shine-text-yellow">api-version: apps/v1</span></div><div><span class="shine-text-yellow">kind: ReplicaSet</span></div><div><span class="shine-text-yellow">metadata:         &nbsp; METADATA OF REPLICATION CONTROLLER</span></div><div><span class="shine-text-yellow"> </span><span class="shine-text-yellow">name: myapp-replicaset   STRING</span></div><div><span class="shine-text-yellow"> </span><span class="shine-text-yellow">labels:&nbsp;          DICTIONARY</span></div><div><span class="shine-text-yellow"> </span><span class="shine-text-yellow"> </span><span class="shine-text-yellow">app: myapp</span></div><div><span class="shine-text-yellow">  tier: front-end<br></span></div><div><br></div><div><span class="shine-text-yellow">spec:&nbsp;</span></div><div><span class="shine-text-yellow"> template:<hr></span></div><div><span class="shine-text-yellow">  metadata:       METADATA OF THE POD<br></span></div><div><span class="shine-text-yellow">   name: myapp-pod<br></span></div><div><span class="shine-text-yellow">   labels:<br></span></div><div><span class="shine-text-yellow">    app: myapp<br></span></div><div><span class="shine-text-yellow">    type: frontend<br></span></div><div><span class="shine-text-yellow">  spec:<br></span></div><div><span class="shine-text-yellow">   containers:<br></span></div><div><span class="shine-text-yellow">   - name: nginx-container<br></span></div><div><span class="shine-text-yellow">   &nbsp; &nbsp;image: nginx</span></div><div><span class="shine-text-yellow"><hr>replicas: 3</span></div><div><span class="shine-text-yellow">selector:</span></div><div><span class="shine-text-yellow"> matchLabels:<br></span></div><div><span class="shine-text-yellow">  type: front-end<br></span></div><div><span class="shine-text-yellow"><br></span></div><div>⁠<div>⁠<b>To create a replicaset:</b></div><div>⁠- kubectl create -f replicaset-definition.yml<span class="shine-text-yellow"><br></span></div><div><br></div><div><b>To view created replicaset:</b></div><div>- kubectl get replicaset</div><div><br></div><div>⁠<b>To view pods created by replicaset:&nbsp;</b>(All their names would start same)<span class="shine-text-yellow"><br></span></div><div>- kubectl get pods</div><span class="shine-text-yellow"><br></span></div><div>⁠<b>To scale a replicaset:</b><br></div><div>- kubectl scale -replicas=6 -f replicaset-definition.yml</div><div>     or</div><div>-&nbsp;<span style="white-space: break-spaces;">kubectl scale rs new-replica-set --replicas=5</span></div></div></body>